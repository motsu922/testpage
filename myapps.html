<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web App Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hidden { display: none; }
        .app-card {
            transition: all 0.2s;
        }
        .app-card:hover img {
            transform: scale(1.02);
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .aspect-video {
            aspect-ratio: 16 / 9;
        }
    </style>
</head>
<body class="bg-white min-h-screen">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="bg-white border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-screen-2xl mx-auto px-4 py-2 flex justify-between items-center">
            <h1 class="text-xl font-bold text-gray-900">ğŸ“± My Apps</h1>
            <div id="authButtons"></div>
        </div>
    </header>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="max-w-screen-2xl mx-auto px-4 py-6">
        
        <!-- ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div id="loginSection" class="hidden max-w-md mx-auto bg-white rounded-lg shadow-md p-8">
            <h2 class="text-2xl font-bold mb-6 text-center">ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h2>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                    <input type="email" id="loginEmail" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                    <input type="password" id="loginPassword" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button type="submit"
                    class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition">
                    ãƒ­ã‚°ã‚¤ãƒ³
                </button>
            </form>
            <p id="loginError" class="text-red-500 text-sm mt-4 text-center hidden"></p>
        </div>

        <!-- ç®¡ç†ç”»é¢ -->
        <div id="adminSection" class="hidden">
            <div class="bg-white rounded-lg shadow-md p-4 sm:p-6 mb-4 sm:mb-6">
                <h2 id="formTitle" class="text-lg sm:text-xl font-bold mb-4">æ–°è¦ã‚¢ãƒ—ãƒªç™»éŒ²</h2>
                <form id="addAppForm" class="space-y-3">
                    <input type="hidden" id="editingAppId" value="">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¢ãƒ—ãƒªå</label>
                        <input type="text" id="appTitle" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">URL</label>
                        <input type="url" id="appUrl" required placeholder="https://example.com"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">èª¬æ˜</label>
                        <textarea id="appDescription" rows="4" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç®¡ç†è€…å‘ã‘ãƒªãƒ³ã‚¯ï¼ˆä»»æ„ï¼‰</label>
                        <div class="space-y-2">
                            <input type="url" id="githubUrl" placeholder="GitHub: https://github.com/..."
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="url" id="firebaseUrl" placeholder="Firebase: https://console.firebase.google.com/..."
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="url" id="otherUrl" placeholder="ãã®ä»–: https://..."
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒ</label>
                        <input type="file" id="appThumbnail" accept="image/*" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        <p class="text-xs text-gray-500 mt-1">ç·¨é›†æ™‚ã¯å¤‰æ›´ã™ã‚‹å ´åˆã®ã¿é¸æŠã—ã¦ãã ã•ã„</p>
                        <img id="currentThumbnail" class="hidden mt-2 w-32 h-32 object-cover rounded-md border">
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" id="submitButton"
                            class="flex-grow bg-green-600 text-white py-2 rounded-md hover:bg-green-700 transition">
                            ã‚¢ãƒ—ãƒªã‚’è¿½åŠ 
                        </button>
                        <button type="button" id="cancelButton" onclick="cancelEdit()" 
                            class="hidden bg-gray-500 text-white px-6 py-2 rounded-md hover:bg-gray-600 transition">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-lg shadow-md p-4 sm:p-6">
                <h2 class="text-lg sm:text-xl font-bold mb-3 sm:mb-4">ç™»éŒ²æ¸ˆã¿ã‚¢ãƒ—ãƒªç®¡ç†</h2>
                <div id="adminAppList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
                    <!-- ç®¡ç†ç”¨ã‚¢ãƒ—ãƒªãƒªã‚¹ãƒˆ -->
                </div>
            </div>
        </div>

        <!-- å…¬é–‹ãƒšãƒ¼ã‚¸ï¼ˆãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªä¸€è¦§ï¼‰ -->
        <div id="publicSection">
            <div id="appList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- ã‚¢ãƒ—ãƒªã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
            </div>
            <p id="noApps" class="text-center text-gray-500 hidden">ã¾ã ã‚¢ãƒ—ãƒªãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
        </div>
    </main>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc, serverTimestamp, orderBy, query } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDxl5a__1aGS-19zn4cQNn6FutP7-q_mag",
            authDomain: "personal-60023.firebaseapp.com",
            projectId: "personal-60023",
            storageBucket: "personal-60023.firebasestorage.app",
            messagingSenderId: "920380998275",
            appId: "1:920380998275:web:1ac685f50fe5f14de191b6"
        };

        // FirebaseåˆæœŸåŒ–
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // DOMè¦ç´ 
        const loginSection = document.getElementById('loginSection');
        const adminSection = document.getElementById('adminSection');
        const publicSection = document.getElementById('publicSection');
        const authButtons = document.getElementById('authButtons');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const addAppForm = document.getElementById('addAppForm');
        const appList = document.getElementById('appList');
        const adminAppList = document.getElementById('adminAppList');
        const noApps = document.getElementById('noApps');

        // èªè¨¼çŠ¶æ…‹ã®ç›£è¦–
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ - ç®¡ç†ç”»é¢ã‚’è¡¨ç¤º
                loginSection.classList.add('hidden');
                adminSection.classList.remove('hidden');
                publicSection.classList.remove('hidden');
                authButtons.innerHTML = `
                    <button onclick="handleLogout()" class="bg-red-600 text-white px-3 py-1.5 sm:px-4 sm:py-2 text-sm sm:text-base rounded-md hover:bg-red-700 transition">
                        ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
                    </button>
                `;
                loadApps(true);
            } else {
                // æœªãƒ­ã‚°ã‚¤ãƒ³ - å…¬é–‹ãƒšãƒ¼ã‚¸ã®ã¿è¡¨ç¤º
                loginSection.classList.add('hidden');
                adminSection.classList.add('hidden');
                publicSection.classList.remove('hidden');
                authButtons.innerHTML = `
                    <button onclick="showLogin()" class="bg-blue-600 text-white px-3 py-1.5 sm:px-4 sm:py-2 text-sm sm:text-base rounded-md hover:bg-blue-700 transition">
                        ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³
                    </button>
                `;
                loadApps(false);
            }
        });

        // ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                await signInWithEmailAndPassword(auth, email, password);
                loginError.classList.add('hidden');
            } catch (error) {
                loginError.textContent = 'ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message;
                loginError.classList.remove('hidden');
            }
        });

        // ã‚¢ãƒ—ãƒªè¿½åŠ /ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
        addAppForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const editingId = document.getElementById('editingAppId').value;
            const title = document.getElementById('appTitle').value;
            const url = document.getElementById('appUrl').value;
            const description = document.getElementById('appDescription').value;
            const githubUrl = document.getElementById('githubUrl').value;
            const firebaseUrl = document.getElementById('firebaseUrl').value;
            const otherUrl = document.getElementById('otherUrl').value;
            const thumbnailFile = document.getElementById('appThumbnail').files[0];

            try {
                // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰
                if (editingId) {
                    const appData = {
                        title,
                        url,
                        description,
                        githubUrl: githubUrl || '',
                        firebaseUrl: firebaseUrl || '',
                        otherUrl: otherUrl || '',
                        updatedAt: serverTimestamp()
                    };

                    // ç”»åƒãŒé¸æŠã•ã‚Œã¦ã„ã‚‹å ´åˆã®ã¿æ›´æ–°
                    if (thumbnailFile) {
                        // å¤ã„ç”»åƒã‚’å‰Šé™¤
                        const apps = await getDocs(collection(db, 'apps'));
                        const oldApp = apps.docs.find(doc => doc.id === editingId);
                        if (oldApp && oldApp.data().thumbnailPath) {
                            const oldImageRef = ref(storage, oldApp.data().thumbnailPath);
                            try {
                                await deleteObject(oldImageRef);
                            } catch (err) {
                                console.log('å¤ã„ç”»åƒã®å‰Šé™¤ã«å¤±æ•—:', err);
                            }
                        }

                        // æ–°ã—ã„ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
                        const storageRef = ref(storage, `thumbnails/${Date.now()}_${thumbnailFile.name}`);
                        await uploadBytes(storageRef, thumbnailFile);
                        const thumbnailUrl = await getDownloadURL(storageRef);
                        appData.thumbnailUrl = thumbnailUrl;
                        appData.thumbnailPath = storageRef.fullPath;
                    }

                    await updateDoc(doc(db, 'apps', editingId), appData);
                    alert('ã‚¢ãƒ—ãƒªã‚’æ›´æ–°ã—ã¾ã—ãŸï¼');
                } 
                // æ–°è¦è¿½åŠ ãƒ¢ãƒ¼ãƒ‰
                else {
                    if (!thumbnailFile) {
                        alert('ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„');
                        return;
                    }

                    // ç”»åƒã‚’Storageã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
                    const storageRef = ref(storage, `thumbnails/${Date.now()}_${thumbnailFile.name}`);
                    await uploadBytes(storageRef, thumbnailFile);
                    const thumbnailUrl = await getDownloadURL(storageRef);

                    // Firestoreã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
                    await addDoc(collection(db, 'apps'), {
                        title,
                        url,
                        description,
                        githubUrl: githubUrl || '',
                        firebaseUrl: firebaseUrl || '',
                        otherUrl: otherUrl || '',
                        thumbnailUrl,
                        thumbnailPath: storageRef.fullPath,
                        createdAt: serverTimestamp()
                    });

                    alert('ã‚¢ãƒ—ãƒªã‚’è¿½åŠ ã—ã¾ã—ãŸï¼');
                }

                resetForm();
                loadApps(true);
            } catch (error) {
                alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            }
        });

        // ã‚¢ãƒ—ãƒªä¸€è¦§ã‚’èª­ã¿è¾¼ã¿
        async function loadApps(isAdmin) {
            try {
                const q = query(collection(db, 'apps'), orderBy('createdAt', 'desc'));
                const querySnapshot = await getDocs(q);
                
                if (querySnapshot.empty) {
                    noApps.classList.remove('hidden');
                    appList.innerHTML = '';
                    if (isAdmin) adminAppList.innerHTML = '';
                    return;
                }

                noApps.classList.add('hidden');
                appList.innerHTML = '';
                if (isAdmin) adminAppList.innerHTML = '';

                querySnapshot.forEach((docSnapshot) => {
                    const app = docSnapshot.data();
                    const appId = docSnapshot.id;
                    
                    // å…¬é–‹ãƒšãƒ¼ã‚¸ç”¨ã‚«ãƒ¼ãƒ‰
                    const card = createAppCard(app);
                    appList.appendChild(card);

                    // ç®¡ç†ç”»é¢ç”¨ã‚«ãƒ¼ãƒ‰
                    if (isAdmin) {
                        const adminCard = createAdminAppCard(app, appId);
                        adminAppList.appendChild(adminCard);
                    }
                });
            } catch (error) {
                console.error('ã‚¢ãƒ—ãƒªã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            }
        }

        // å…¬é–‹ãƒšãƒ¼ã‚¸ç”¨ã‚¢ãƒ—ãƒªã‚«ãƒ¼ãƒ‰ä½œæˆ
        function createAppCard(app) {
            const card = document.createElement('div');
            card.className = 'app-card cursor-pointer';
            card.innerHTML = `
                <div class="mb-4">
                    <img src="${app.thumbnailUrl}" alt="${app.title}" class="w-full aspect-video object-cover rounded-xl">
                </div>
                <div class="flex gap-3">
                    <div class="flex-1 min-w-0">
                        <h3 class="text-base font-semibold mb-2 line-clamp-2 leading-tight">${app.title}</h3>
                        <p class="text-sm text-gray-600 line-clamp-2 leading-relaxed mb-3">${app.description}</p>
                        <a href="${app.url}" target="_blank" rel="noopener noreferrer"
                            class="inline-block text-sm text-blue-600 hover:text-blue-800 font-medium">
                            é–‹ã â†’
                        </a>
                    </div>
                </div>
            `;
            return card;
        }

        // ç®¡ç†ç”»é¢ç”¨ã‚¢ãƒ—ãƒªã‚«ãƒ¼ãƒ‰ä½œæˆ
        function createAdminAppCard(app, appId) {
            const card = document.createElement('div');
            card.className = 'bg-gray-50 rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition';
            
            // ç®¡ç†è€…å‘ã‘ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
            let adminLinks = '';
            if (app.githubUrl || app.firebaseUrl || app.otherUrl) {
                adminLinks = '<div class="flex gap-1 mb-2">';
                if (app.githubUrl) {
                    adminLinks += `<a href="${app.githubUrl}" target="_blank" class="flex-1 bg-gray-700 text-white px-2 py-1 text-xs rounded hover:bg-gray-800 transition text-center" title="GitHub">ğŸ”— GitHub</a>`;
                }
                if (app.firebaseUrl) {
                    adminLinks += `<a href="${app.firebaseUrl}" target="_blank" class="flex-1 bg-orange-500 text-white px-2 py-1 text-xs rounded hover:bg-orange-600 transition text-center" title="Firebase">ğŸ”¥ Firebase</a>`;
                }
                if (app.otherUrl) {
                    adminLinks += `<a href="${app.otherUrl}" target="_blank" class="flex-1 bg-purple-500 text-white px-2 py-1 text-xs rounded hover:bg-purple-600 transition text-center" title="ãã®ä»–">ğŸ”— Other</a>`;
                }
                adminLinks += '</div>';
            }
            
            card.innerHTML = `
                <img src="${app.thumbnailUrl}" alt="${app.title}" class="w-full aspect-video object-cover">
                <div class="p-3">
                    <h4 class="font-bold text-sm mb-1 truncate">${app.title}</h4>
                    <p class="text-gray-600 text-xs truncate mb-3">${app.url}</p>
                    ${adminLinks}
                    <div class="flex gap-2">
                        <button onclick="editApp('${appId}')"
                            class="flex-1 bg-blue-600 text-white px-2 py-1.5 text-xs rounded hover:bg-blue-700 transition">
                            ç·¨é›†
                        </button>
                        <button onclick="deleteApp('${appId}')"
                            class="flex-1 bg-red-600 text-white px-2 py-1.5 text-xs rounded hover:bg-red-700 transition">
                            å‰Šé™¤
                        </button>
                    </div>
                </div>
            `;
            return card;
        }

        // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
        window.handleLogout = async () => {
            try {
                await signOut(auth);
            } catch (error) {
                alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ');
            }
        };

        // ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢è¡¨ç¤º
        window.showLogin = () => {
            loginSection.classList.remove('hidden');
            publicSection.classList.add('hidden');
        };

        // ã‚¢ãƒ—ãƒªå‰Šé™¤
        window.deleteApp = async (appId) => {
            if (!confirm('æœ¬å½“ã«ã“ã®ã‚¢ãƒ—ãƒªã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;

            try {
                // ã‚¢ãƒ—ãƒªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const apps = await getDocs(collection(db, 'apps'));
                const appDoc = apps.docs.find(doc => doc.id === appId);
                
                if (appDoc) {
                    const appData = appDoc.data();
                    
                    // Storageã‹ã‚‰ç”»åƒã‚’å‰Šé™¤
                    if (appData.thumbnailPath) {
                        const imageRef = ref(storage, appData.thumbnailPath);
                        try {
                            await deleteObject(imageRef);
                        } catch (err) {
                            console.log('ç”»åƒã®å‰Šé™¤ã«å¤±æ•—:', err);
                        }
                    }

                    // Firestoreã‹ã‚‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤
                    await deleteDoc(doc(db, 'apps', appId));

                    alert('ã‚¢ãƒ—ãƒªã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
                    loadApps(true);
                }
            } catch (error) {
                alert('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            }
        };

        // ã‚¢ãƒ—ãƒªç·¨é›†
        window.editApp = async (appId) => {
            try {
                // Firestoreã‹ã‚‰ã‚¢ãƒ—ãƒªã‚’å–å¾—
                const apps = await getDocs(collection(db, 'apps'));
                const appDoc = apps.docs.find(doc => doc.id === appId);
                
                if (!appDoc) return;
                
                const app = appDoc.data();

                // ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’ã‚»ãƒƒãƒˆ
                document.getElementById('editingAppId').value = appId;
                document.getElementById('appTitle').value = app.title;
                document.getElementById('appUrl').value = app.url;
                document.getElementById('appDescription').value = app.description;
                document.getElementById('githubUrl').value = app.githubUrl || '';
                document.getElementById('firebaseUrl').value = app.firebaseUrl || '';
                document.getElementById('otherUrl').value = app.otherUrl || '';
                
                // ç¾åœ¨ã®ã‚µãƒ ãƒã‚¤ãƒ«ã‚’è¡¨ç¤º
                const currentThumbnail = document.getElementById('currentThumbnail');
                currentThumbnail.src = app.thumbnailUrl;
                currentThumbnail.classList.remove('hidden');
                
                // ã‚µãƒ ãƒã‚¤ãƒ«å…¥åŠ›ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ã«
                document.getElementById('appThumbnail').removeAttribute('required');
                
                // UIã‚’ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«å¤‰æ›´
                document.getElementById('formTitle').textContent = 'ã‚¢ãƒ—ãƒªç·¨é›†';
                document.getElementById('submitButton').textContent = 'æ›´æ–°ã™ã‚‹';
                document.getElementById('submitButton').className = 'flex-grow bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition';
                document.getElementById('cancelButton').classList.remove('hidden');
                
                // ãƒ•ã‚©ãƒ¼ãƒ ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                document.getElementById('addAppForm').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                alert('ç·¨é›†ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            }
        };

        // ç·¨é›†ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        window.cancelEdit = () => {
            resetForm();
        };

        // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
        function resetForm() {
            addAppForm.reset();
            document.getElementById('editingAppId').value = '';
            document.getElementById('githubUrl').value = '';
            document.getElementById('firebaseUrl').value = '';
            document.getElementById('otherUrl').value = '';
            document.getElementById('currentThumbnail').classList.add('hidden');
            document.getElementById('appThumbnail').setAttribute('required', 'required');
            document.getElementById('formTitle').textContent = 'æ–°è¦ã‚¢ãƒ—ãƒªç™»éŒ²';
            document.getElementById('submitButton').textContent = 'ã‚¢ãƒ—ãƒªã‚’è¿½åŠ ';
            document.getElementById('submitButton').className = 'flex-grow bg-green-600 text-white py-2 rounded-md hover:bg-green-700 transition';
            document.getElementById('cancelButton').classList.add('hidden');
        }
    </script>
</body>
</html>
